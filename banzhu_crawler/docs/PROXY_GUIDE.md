# 代理服务器配置指南

## 问题说明

当访问目标网站时，可能会遇到IP封禁问题，表现为以下错误信息：
- 403 Forbidden
- Access denied
- Ray ID错误

这是因为目标网站实施了反爬虫机制，封禁了频繁访问的IP地址。

## 解决方案

为了绕过IP封禁，系统支持两种代理配置方式：

### 1. 自动获取代理（推荐）
系统可以自动从免费代理源获取代理服务器列表，并自动验证其有效性。

### 2. 手动配置代理
您可以手动配置代理服务器。代理服务器可以：
1. 使用不同的IP地址访问目标网站
2. 分散请求负载
3. 提高访问成功率

## 配置方法

### 1. 自动代理获取
系统默认启用自动代理获取功能，无需额外配置。系统会定期从免费代理源获取代理列表并验证其有效性。

### 2. 后端配置（推荐）

在 `src/web/banzhu_web.py` 文件中找到代理服务器池配置部分：

```python
# 代理服务器池（用户可以在这里添加自己的代理服务器）
proxies = [
    # 格式: {'http': 'http://user:password@ip:port', 'https': 'http://user:password@ip:port'}
    # 示例: {'http': 'http://proxyuser:proxypass@1.2.3.4:8080', 'https': 'http://proxyuser:proxypass@1.2.3.4:8080'}
    # 免费代理示例（请替换为有效的代理服务器）:
    # {'http': 'http://1.2.3.4:8080', 'https': 'http://1.2.3.4:8080'},
    # {'http': 'http://5.6.7.8:3128', 'https': 'http://5.6.7.8:3128'}
]
```

添加您的代理服务器配置，例如：

```python
# 代理服务器池（用户可以在这里添加自己的代理服务器）
proxies = [
    {'http': 'http://proxyuser:proxypass@1.2.3.4:8080', 'https': 'http://proxyuser:proxypass@1.2.3.4:8080'},
    {'http': 'http://proxyuser:proxypass@5.6.7.8:8080', 'https': 'http://proxyuser:proxypass@5.6.7.8:8080'},
    {'http': 'http://10.11.12.13:3128', 'https': 'http://10.11.12.13:3128'}
]
```

### 2. 前端配置（提示信息）

在网页界面的代理配置区域可以查看和编辑代理配置，但请注意：
- 前端配置仅作为提示信息显示
- 实际生效需要在后端代码中配置

## 代理服务器获取

### 自动获取
系统会自动从以下免费代理源获取代理列表：
1. ProxyList.download
2. ProxyScrape

系统会自动验证代理的有效性并定期更新代理列表。

> 注意：免费代理源可能因网络问题或源站维护而暂时不可用，这是正常现象。系统会在下次更新时重新尝试获取。

### 免费代理
1. 从免费代理网站获取（稳定性较差）
2. 注意验证代理的有效性和匿名性

### 付费代理
1. 购买专业的代理服务（稳定性好）
2. 通常提供API接口获取可用代理列表

### 自建代理
1. 使用云服务器搭建代理服务
2. 安全性最高但成本较高

## 注意事项

1. 代理服务器的有效性会随时间变化，请定期更新
2. 使用代理会增加访问延迟，请合理设置超时时间
3. 遵守目标网站的使用条款，合理控制访问频率
4. 某些代理可能被目标网站封禁，需要及时更换

## 故障排除

如果配置代理后仍然遇到问题：
1. 检查代理服务器是否有效
2. 验证代理格式是否正确
3. 尝试更换其他代理服务器
4. 联系系统管理员获取帮助